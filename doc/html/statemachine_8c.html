<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Unix-Linux Process Programming Kit (ulppk): ulppk/statemachine.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Unix-Linux Process Programming Kit (ulppk)
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">A set of robust lightweight components for multi-process and/or networked  applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('statemachine_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">statemachine.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of the statemachine mechanism.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="statemachine_8h_source.html">statemachine.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="pathinfo_8h_source.html">pathinfo.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="appenv_8h_source.html">appenv.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="sysconfig_8h_source.html">sysconfig.h</a>&gt;</code><br/>
</div>
<p><a href="statemachine_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac0ffee58c82af2eb38482a6f8ffe3a38"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#ac0ffee58c82af2eb38482a6f8ffe3a38">_SM_LOGGING</a></td></tr>
<tr class="separator:ac0ffee58c82af2eb38482a6f8ffe3a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa36a20aa199b4199974a844a50bda0ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#aa36a20aa199b4199974a844a50bda0ea">SMLOG</a>(...)&#160;&#160;&#160;smlog( __VA_ARGS__ );</td></tr>
<tr class="separator:aa36a20aa199b4199974a844a50bda0ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a418dfd0ce90fb647a4732296710629d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a418dfd0ce90fb647a4732296710629d5">SMOPENLOG</a>(a)&#160;&#160;&#160;smopenlog(a);</td></tr>
<tr class="separator:a418dfd0ce90fb647a4732296710629d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a021f689a24c7ce59496ab4f0e86df5e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a021f689a24c7ce59496ab4f0e86df5e8">SMCLOSELOG</a>&#160;&#160;&#160;smclose_log();</td></tr>
<tr class="separator:a021f689a24c7ce59496ab4f0e86df5e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae840790e4f5ae98c977e2c36e3404606"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#ae840790e4f5ae98c977e2c36e3404606">sm_register_event</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, const char *name)</td></tr>
<tr class="memdesc:ae840790e4f5ae98c977e2c36e3404606"><td class="mdescLeft">&#160;</td><td class="mdescRight">State machine event registration.  <a href="#ae840790e4f5ae98c977e2c36e3404606">More...</a><br/></td></tr>
<tr class="separator:ae840790e4f5ae98c977e2c36e3404606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf272616d5e0b04d25dd4ba8a1518d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="statemachine_8h.html#a6f0ccd0b6cfa6e37d337d865442ee93b">SM_ACTION_LIST_HANDLE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#abcf272616d5e0b04d25dd4ba8a1518d0">sm_register_action_list</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, const char *name)</td></tr>
<tr class="memdesc:abcf272616d5e0b04d25dd4ba8a1518d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a state machine action list.  <a href="#abcf272616d5e0b04d25dd4ba8a1518d0">More...</a><br/></td></tr>
<tr class="separator:abcf272616d5e0b04d25dd4ba8a1518d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a702e35ffdeebad7d1f384659a270a293"><td class="memItemLeft" align="right" valign="top"><a class="el" href="statemachine_8h.html#a49cb86c3ee19747e43ffc473b6ba14a0">SM_ACTION_HANDLE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a702e35ffdeebad7d1f384659a270a293">sm_register_action</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, const char *actlist_name, const char *name, <a class="el" href="statemachine_8h.html#ac2460354b049c36e1a12924bbda9e3ea">SM_ACTION_HANDLER</a> *handlerp)</td></tr>
<tr class="memdesc:a702e35ffdeebad7d1f384659a270a293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a state machine action by adding it to an action list.  <a href="#a702e35ffdeebad7d1f384659a270a293">More...</a><br/></td></tr>
<tr class="separator:a702e35ffdeebad7d1f384659a270a293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f26f55a19b71ea089f4ba1caf2e0641"><td class="memItemLeft" align="right" valign="top"><a class="el" href="statemachine_8h.html#aa30fadf137d8a09eceea2a2d973be5ef">SM_STATE_HANDLE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a7f26f55a19b71ea089f4ba1caf2e0641">sm_register_state</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, const char *name)</td></tr>
<tr class="separator:a7f26f55a19b71ea089f4ba1caf2e0641"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f9de16e4ea426ea86eb17a5d2d42d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="statemachine_8h.html#ad54088a07933f08c1ea4cc72c6a14925">SM_TRANSITION_HANDLE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#ab1f9de16e4ea426ea86eb17a5d2d42d9">sm_register_transition</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, const char *s1name, const char *s2name, const char *evname, const char *actlist_name)</td></tr>
<tr class="memdesc:ab1f9de16e4ea426ea86eb17a5d2d42d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register state transitions.  <a href="#ab1f9de16e4ea426ea86eb17a5d2d42d9">More...</a><br/></td></tr>
<tr class="separator:ab1f9de16e4ea426ea86eb17a5d2d42d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa25f85c5dc6ad3dd045501017882d8c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#afa25f85c5dc6ad3dd045501017882d8c">sm_register_global_transition</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, const char *s2name, const char *evname, const char *actlist_name)</td></tr>
<tr class="memdesc:afa25f85c5dc6ad3dd045501017882d8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a global transition.  <a href="#afa25f85c5dc6ad3dd045501017882d8c">More...</a><br/></td></tr>
<tr class="separator:afa25f85c5dc6ad3dd045501017882d8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a615a8f05521ec3112ea91c38ecd48b6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a615a8f05521ec3112ea91c38ecd48b6c">sm_register_stock_defs</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="separator:a615a8f05521ec3112ea91c38ecd48b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39fa7373ae662d47b3b9c772add4840f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a39fa7373ae662d47b3b9c772add4840f">sm_new_machine</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, <a class="el" href="struct_s_m___s_t_a_t_e___t_a_b_l_e___d_e_f.html">SM_STATE_TABLE_DEF</a> *stdefp, const char *machine_name)</td></tr>
<tr class="separator:a39fa7373ae662d47b3b9c772add4840f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba3c23f13377961b72ec364b75f2942"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a5ba3c23f13377961b72ec364b75f2942">sm_reset_machine</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="memdesc:a5ba3c23f13377961b72ec364b75f2942"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a state machine object. This is like sm_new_machine, except you don't have to re-establish the states, events, actions and such.  <a href="#a5ba3c23f13377961b72ec364b75f2942">More...</a><br/></td></tr>
<tr class="separator:a5ba3c23f13377961b72ec364b75f2942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a298c4956620a135d748500a6371106d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="statemachine_8h.html#a70482ff48418e4ab7788b695da116f0d">SM_ERROR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a298c4956620a135d748500a6371106d6">sm_transition</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, const char *event_name, void *datap)</td></tr>
<tr class="memdesc:a298c4956620a135d748500a6371106d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main transition processor. Should not be called until machine has been started by calling sm_set_definition_complete to mark the definition of the state/transition tables to be complete. The machine is currently in state s1. The incoming event named by event_name selects a transition. If no transition matching the incoming event is found, no transition occurs but the function and sm_errno(machinep) return non-zero. The datap is provided to the action handlers which are members of the transition's action list. Any action handler can return the events EVH_NULL, meaning no event, or EV_ABORT indicating the machine is in a bad state. Action handlers may also return custom events. These will get pushed onto the event queue. After the transition is complete, the event queue is serviced, which may trigger additional transitions.  <a href="#a298c4956620a135d748500a6371106d6">More...</a><br/></td></tr>
<tr class="separator:a298c4956620a135d748500a6371106d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e4a1bfc015d88f116f2afa64acb778"><td class="memItemLeft" align="right" valign="top"><a class="el" href="statemachine_8h.html#acb17336d3c3a21ee8233cec54bb55b4f">SM_EVENT_HANDLE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a64e4a1bfc015d88f116f2afa64acb778">sm_event_handle</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep, const char *evname)</td></tr>
<tr class="memdesc:a64e4a1bfc015d88f116f2afa64acb778"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a state machine and a event name string, retrieve the event handle.  <a href="#a64e4a1bfc015d88f116f2afa64acb778">More...</a><br/></td></tr>
<tr class="separator:a64e4a1bfc015d88f116f2afa64acb778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946f6fd21246909c4e299626082b2235"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a946f6fd21246909c4e299626082b2235">sm_curr_state</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="memdesc:a946f6fd21246909c4e299626082b2235"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the name string of the current machine state.  <a href="#a946f6fd21246909c4e299626082b2235">More...</a><br/></td></tr>
<tr class="separator:a946f6fd21246909c4e299626082b2235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07924741d0c93b2d21696fa3c7d76141"><td class="memItemLeft" align="right" valign="top"><a class="el" href="statemachine_8h.html#a70482ff48418e4ab7788b695da116f0d">SM_ERROR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a07924741d0c93b2d21696fa3c7d76141">sm_errno</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="memdesc:a07924741d0c93b2d21696fa3c7d76141"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the last machine error posted on the machine.  <a href="#a07924741d0c93b2d21696fa3c7d76141">More...</a><br/></td></tr>
<tr class="separator:a07924741d0c93b2d21696fa3c7d76141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f41e9efa7f5839ff50d471b84d1d27"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#ab3f41e9efa7f5839ff50d471b84d1d27">sm_strerror</a> (<a class="el" href="statemachine_8h.html#a70482ff48418e4ab7788b695da116f0d">SM_ERROR</a> errcode)</td></tr>
<tr class="memdesc:ab3f41e9efa7f5839ff50d471b84d1d27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience function for getting string interpretation of an error code.  <a href="#ab3f41e9efa7f5839ff50d471b84d1d27">More...</a><br/></td></tr>
<tr class="separator:ab3f41e9efa7f5839ff50d471b84d1d27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477ebff176894deea265f7eb17fc3d2c"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a477ebff176894deea265f7eb17fc3d2c">sm_strdiag</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="memdesc:a477ebff176894deea265f7eb17fc3d2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format error text. Updates the errtext field of the state machine structure.  <a href="#a477ebff176894deea265f7eb17fc3d2c">More...</a><br/></td></tr>
<tr class="separator:a477ebff176894deea265f7eb17fc3d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec396042d2c8797cfbe749cdb460938"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a3ec396042d2c8797cfbe749cdb460938">sm_pop_tx_error</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="separator:a3ec396042d2c8797cfbe749cdb460938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4bd28b0a35ed1262d9bd536f48bcd5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#ac4bd28b0a35ed1262d9bd536f48bcd5a">sm_set_definition_complete</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="memdesc:ac4bd28b0a35ed1262d9bd536f48bcd5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the state definition complete flag for the machine's state definition table. Note that this will affect ALL machines that share a particular state definition table.  <a href="#ac4bd28b0a35ed1262d9bd536f48bcd5a">More...</a><br/></td></tr>
<tr class="separator:ac4bd28b0a35ed1262d9bd536f48bcd5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cdcb05b77d1147b1748d9562e0e6fe0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a0cdcb05b77d1147b1748d9562e0e6fe0">sm_get_definition_complete</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="memdesc:a0cdcb05b77d1147b1748d9562e0e6fe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the state table definition complete flag for a particular machine.  <a href="#a0cdcb05b77d1147b1748d9562e0e6fe0">More...</a><br/></td></tr>
<tr class="separator:a0cdcb05b77d1147b1748d9562e0e6fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a8f18cce686180d65371f17a614d85c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="statemachine_8c.html#a4a8f18cce686180d65371f17a614d85c">sm_close_machine</a> (<a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *machinep)</td></tr>
<tr class="memdesc:a4a8f18cce686180d65371f17a614d85c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes the state machine. After this, machinep MUST be reset using sm_reset_machine if you want to re-use the machine structure.  <a href="#a4a8f18cce686180d65371f17a614d85c">More...</a><br/></td></tr>
<tr class="separator:a4a8f18cce686180d65371f17a614d85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of the statemachine mechanism. </p>
<p>This package provides definitions and a framework for implementing classic Ward/Mellor state machines. A state machine is described by a graph consisting of</p>
<ol>
<li>
A set of states. </li>
<li>
A set of transitions connecting the states </li>
</ol>
<p>Transitions are triggered by events and implemented by one or more actions. The sequence of actions is expressed in a list. The individual actions are performed in the order they are given on the list.</p>
<p>The triggering event, action list, initial state and final state are considered properties of the transitions. The semantics could be expressed: When in state S1, when event E1 occurs, perform action list AL1 and transition to State S2.</p>
<p>Nomenclature: </p>
<ul>
<li>
tx =&gt; transition </li>
<li>
ev =&gt; event </li>
<li>
al =&gt; action list </li>
<li>
ax =&gt; action (member of action list) </li>
<li>
st =&gt; state </li>
</ul>
<p>WARNING: This package is designed under the guiding philosophy of "Strong
typing is for weak minds." Stick to it. Or else. :D</p>
<h3>NOTES ON MULTIPLE MACHINES USING THE SAME DEFINITIONS</h3>
<p>To create a machine. (This machine is allocated off the heap.)</p>
<p>static * <a class="el" href="struct_s_m___s_t_a_t_e___t_a_b_l_e___d_e_f.html">SM_STATE_TABLE_DEF</a> mydefs;</p>
<p>machine1p = sm_new_machine(NULL, &amp;mydefs, "mymachine1");</p>
<p>Now register events, action lists, Then create a second machine reusing the definitions table:</p>
<p>machine2p = sm_new_machine(NULL, &amp;mydefs, "mymachine2")</p>
<h3>NOTES ON LOGGING:</h3>
<p>If you want log statemachine operations to the system logger, then uncomment the define below or configure with -D_STATEMACHINE_USE_SYSLOG. e.g.</p>
<p>env CFLAGS="-g -O0 -D_STATEMACHINE_USE_SYSLOG_" ./configure</p>
<p>The default is to log to [logdir]/[appname].statemachine.log where [logdir] is the value of environment variable SYSCONFIG_LOG_DIR [appname] is the value of environment variable SYSCONFIG_APPNAME</p>
<p>If SYSLOG is used for logging, then the package is counting on the calling program to properly call openlog and set up use of the system logger. (That is normally done using ulppk_log functions.) </p>

<p>Definition in file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ac0ffee58c82af2eb38482a6f8ffe3a38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _SM_LOGGING</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00150">150</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a021f689a24c7ce59496ab4f0e86df5e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMCLOSELOG&#160;&#160;&#160;smclose_log();</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00155">155</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa36a20aa199b4199974a844a50bda0ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMLOG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td>&#160;&#160;&#160;smlog( __VA_ARGS__ );</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00153">153</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a418dfd0ce90fb647a4732296710629d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMOPENLOG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;smopenlog(a);</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00154">154</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4a8f18cce686180d65371f17a614d85c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sm_close_machine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes the state machine. After this, machinep MUST be reset using sm_reset_machine if you want to re-use the machine structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00959">959</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a946f6fd21246909c4e299626082b2235"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* sm_curr_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the name string of the current machine state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Name of the current machine state/ </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00847">847</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a07924741d0c93b2d21696fa3c7d76141"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="statemachine_8h.html#a70482ff48418e4ab7788b695da116f0d">SM_ERROR</a> sm_errno </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the last machine error posted on the machine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an SM_ERROR code (SM_NO_ERROR = 0 indicates success) </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00857">857</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a64e4a1bfc015d88f116f2afa64acb778"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="statemachine_8h.html#acb17336d3c3a21ee8233cec54bb55b4f">SM_EVENT_HANDLE</a> sm_event_handle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>evname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a state machine and a event name string, retrieve the event handle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
    <tr><td class="paramname">evname</td><td>Name of the event of interest. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SM_NULL_HANDLE if not found. Otherwise, event handle. </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00836">836</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0cdcb05b77d1147b1748d9562e0e6fe0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sm_get_definition_complete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the state table definition complete flag for a particular machine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if statemachine definition has been posted as being compelte, 0 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00949">949</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a39fa7373ae662d47b3b9c772add4840f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a>* sm_new_machine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_s_m___s_t_a_t_e___t_a_b_l_e___d_e_f.html">SM_STATE_TABLE_DEF</a> *&#160;</td>
          <td class="paramname"><em>stdefp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>machine_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00686">686</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3ec396042d2c8797cfbe749cdb460938"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* sm_pop_tx_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called to retrieve errors stacked on a state machine's error collection. Useful for diagnosing problems with the state transition table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to transition diagnostic text. </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00914">914</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a702e35ffdeebad7d1f384659a270a293"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="statemachine_8h.html#a49cb86c3ee19747e43ffc473b6ba14a0">SM_ACTION_HANDLE</a> sm_register_action </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>actlist_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#ac2460354b049c36e1a12924bbda9e3ea">SM_ACTION_HANDLER</a> *&#160;</td>
          <td class="paramname"><em>handlerp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a state machine action by adding it to an action list. </p>
<p>After action lists have been registered, register the actual action handlers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
    <tr><td class="paramname">actlist_name</td><td>Name of the action list to which the handler must be added. </td></tr>
    <tr><td class="paramname">name</td><td>Name of the action handler </td></tr>
    <tr><td class="paramname">handlerp</td><td>Pointer to the actual action handler function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SM_ACTION_HANDLE of the created action handler (an integer) </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00464">464</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="abcf272616d5e0b04d25dd4ba8a1518d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="statemachine_8h.html#a6f0ccd0b6cfa6e37d337d865442ee93b">SM_ACTION_LIST_HANDLE</a> sm_register_action_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a state machine action list. </p>
<p>Action list registration normally follows event registration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
    <tr><td class="paramname">name</td><td>Name of the action list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SM_ACTION_LIST_HANDLE of the created action list (an integer) </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00429">429</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae840790e4f5ae98c977e2c36e3404606"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sm_register_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>State machine event registration. </p>
<p>Define your events first using this function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
    <tr><td class="paramname">name</td><td>Name of the event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SM_EVENT_HANDLE of the created event (an integer) </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00398">398</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="afa25f85c5dc6ad3dd045501017882d8c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sm_register_global_transition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s2name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>evname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>actlist_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a global transition. </p>
<p>Global transitions are useful for common error handling. For example, presume that all the states on the state/transition graph must handle the event EV_MYERROR, and that after handling the event the machine should land in the state MY_ERROR STATE. A common action list can be composed for this error event, Rather than register the event and action list for each defined state, call sm_register_global_transition to apply the transition to all the defined states. Restrictions: 1) ALL states must be required to handle the triggering event. 2) The same end state must be reached in all cases. 3) The same action list must be applied to the triggering event. 4) No other transition must be triggered by the event that triggers the global transition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
    <tr><td class="paramname">s2name</td><td>Name of the final state </td></tr>
    <tr><td class="paramname">evname</td><td>Name of the trigger event </td></tr>
    <tr><td class="paramname">actlist_name</td><td>Name of the action list to be executed on receipt of the triggering event. @ return 0 if successful and non-zero otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00634">634</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7f26f55a19b71ea089f4ba1caf2e0641"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="statemachine_8h.html#aa30fadf137d8a09eceea2a2d973be5ef">SM_STATE_HANDLE</a> sm_register_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00514">514</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a615a8f05521ec3112ea91c38ecd48b6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sm_register_stock_defs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register predefined events and other convenience objects </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00667">667</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab1f9de16e4ea426ea86eb17a5d2d42d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="statemachine_8h.html#ad54088a07933f08c1ea4cc72c6a14925">SM_TRANSITION_HANDLE</a> sm_register_transition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s1name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s2name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>evname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>actlist_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register state transitions. </p>
<p>Once events, action lists, action handlers, and states have been registered, transitions between states can be registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
    <tr><td class="paramname">s1name</td><td>Name of the initial state </td></tr>
    <tr><td class="paramname">s2name</td><td>Name of the final state </td></tr>
    <tr><td class="paramname">evname</td><td>Name of the triggereding event </td></tr>
    <tr><td class="paramname">actlist_name</td><td>Name of the action list to execute on receipt of the triggering event. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SM_TRANSITION_HANDLE of the created transition (an integer) </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00549">549</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5ba3c23f13377961b72ec364b75f2942"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sm_reset_machine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a state machine object. This is like sm_new_machine, except you don't have to re-establish the states, events, actions and such. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00711">711</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac4bd28b0a35ed1262d9bd536f48bcd5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sm_set_definition_complete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the state definition complete flag for the machine's state definition table. Note that this will affect ALL machines that share a particular state definition table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00939">939</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a477ebff176894deea265f7eb17fc3d2c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* sm_strdiag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Format error text. Updates the errtext field of the state machine structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to formatted text string. </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00891">891</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab3f41e9efa7f5839ff50d471b84d1d27"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* sm_strerror </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a70482ff48418e4ab7788b695da116f0d">SM_ERROR</a>&#160;</td>
          <td class="paramname"><em>errcode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convenience function for getting string interpretation of an error code. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errcode</td><td>Numeric error code (see <a class="el" href="statemachine_8h.html" title="This package provides definitions and a framework for implementing classic Ward/Mellor state machines...">statemachine.h</a> type SM_ERROR) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error text message string. </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00867">867</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
<a class="anchor" id="a298c4956620a135d748500a6371106d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="statemachine_8h.html#a70482ff48418e4ab7788b695da116f0d">SM_ERROR</a> sm_transition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="statemachine_8h.html#a17a6221287f20ca75fef19be0fc19952">SM_MACHINE</a> *&#160;</td>
          <td class="paramname"><em>machinep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>datap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main transition processor. Should not be called until machine has been started by calling sm_set_definition_complete to mark the definition of the state/transition tables to be complete. The machine is currently in state s1. The incoming event named by event_name selects a transition. If no transition matching the incoming event is found, no transition occurs but the function and sm_errno(machinep) return non-zero. The datap is provided to the action handlers which are members of the transition's action list. Any action handler can return the events EVH_NULL, meaning no event, or EV_ABORT indicating the machine is in a bad state. Action handlers may also return custom events. These will get pushed onto the event queue. After the transition is complete, the event queue is serviced, which may trigger additional transitions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinep</td><td>Pointer to SM_MACHINE structure for the statemachine </td></tr>
    <tr><td class="paramname">event_name</td><td>Name of the incoming event </td></tr>
    <tr><td class="paramname">datap</td><td>Application defined data to be passed to action handler functions during transition </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an SM_ERROR code (SM_NO_ERROR = 0 indicates success) </dd></dl>

<p>Definition at line <a class="el" href="statemachine_8c_source.html#l00742">742</a> of file <a class="el" href="statemachine_8c_source.html">statemachine.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f97c989b391daa71637b76dbb104447e.html">ulppk</a></li><li class="navelem"><a class="el" href="statemachine_8c.html">statemachine.c</a></li>
    <li class="footer">Generated on Thu Aug 27 2015 00:33:47 for Unix-Linux Process Programming Kit (ulppk) by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
