\hypertarget{msgdeque_8c}{\section{ulppk/msgdeque.c File Reference}
\label{msgdeque_8c}\index{ulppk/msgdeque.\-c@{ulppk/msgdeque.\-c}}
}


Message Deque Facility for Inter-\/process Communications.  


{\ttfamily \#include $<$msgdeque.\-h$>$}\\*
{\ttfamily \#include $<$msgcell.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$ulppk\-\_\-log.\-h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{msgdeque_8c_a6e6c3ac1e4ac58370515721b187b2758}{D\-E\-Q\-U\-E\-P\-R\-E\-F\-I\-X}~\char`\"{}msgdeque-\/\char`\"{}
\item 
\#define \hyperlink{msgdeque_8c_ab34725ee75fd5fcf782cd33cfffa8601}{L\-O\-C\-K\-P\-R\-E\-F\-I\-X}~\char`\"{}msgdeque-\/lock-\/\char`\"{}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{msgdeque_8c_af1ab89e5113e335fb7f329f700eef400}{msgdeque\-\_\-datacheck} (void $\ast$datap)
\begin{DoxyCompactList}\small\item\em Data check function for message deques. \end{DoxyCompactList}\item 
\hyperlink{msgcell_8h_ab374f08df1c05b1837ad2e4f130d3cca}{M\-S\-G\-C\-E\-L\-L} $\ast$ \hyperlink{msgdeque_8c_a3be2abb141dd705931d15e996335d302}{msgdeque\-\_\-create} (const char $\ast$name, uint permissions, ushort item\-\_\-size, ushort nitems)
\begin{DoxyCompactList}\small\item\em Create a message deque structure. This will consist of at msgcell and a memory mapped dequeue. This form sets up a message dequeue that accepts records of a fixed length specified by item\-\_\-size. \end{DoxyCompactList}\item 
\hyperlink{msgcell_8h_ab374f08df1c05b1837ad2e4f130d3cca}{M\-S\-G\-C\-E\-L\-L} $\ast$ \hyperlink{msgdeque_8c_adf55d7fab84947e2c15bb9878bcae0d7}{msgdeque\-\_\-create\-\_\-byte\-\_\-stream} (const char $\ast$name, uint permissions, ushort byte\-\_\-capacity)
\begin{DoxyCompactList}\small\item\em Create a message deque structure for \char`\"{}byte streams\char`\"{}. This will consist of at msgcell and a memory mapped dequeue. This function sets up a message dequeue that accepts variable length byte sequences. \end{DoxyCompactList}\item 
\hyperlink{msgcell_8h_ab374f08df1c05b1837ad2e4f130d3cca}{M\-S\-G\-C\-E\-L\-L} $\ast$ \hyperlink{msgdeque_8c_aecaab2ef8f017bd42fcb1ad62845a3b4}{msgdeque\-\_\-attach} (const char $\ast$name)
\begin{DoxyCompactList}\small\item\em Attach to a previously created message deque. \end{DoxyCompactList}\item 
int \hyperlink{msgdeque_8c_a39f497a1b7d9d650af064d383886b818}{msgdeque\-\_\-reset} (\hyperlink{msgcell_8h_ab374f08df1c05b1837ad2e4f130d3cca}{M\-S\-G\-C\-E\-L\-L} $\ast$msgcellp)
\begin{DoxyCompactList}\small\item\em Reset a message deque to the empty state and clear the sempahore. \end{DoxyCompactList}\item 
int \hyperlink{msgdeque_8c_afb93eb01c51f6b01f37c43771c416ee7}{msgdeque\-\_\-send} (\hyperlink{msgcell_8h_ab374f08df1c05b1837ad2e4f130d3cca}{M\-S\-G\-C\-E\-L\-L} $\ast$msgcellp, void $\ast$sendp)
\item 
void $\ast$ \hyperlink{msgdeque_8c_ab12130a3596f957f0aa9f26c5619c21b}{msgdeque\-\_\-rec} (\hyperlink{msgcell_8h_ab374f08df1c05b1837ad2e4f130d3cca}{M\-S\-G\-C\-E\-L\-L} $\ast$msgcellp)
\item 
int \hyperlink{msgdeque_8c_aed54e36c001d914878bc7b9d493301ac}{msgdeque\-\_\-send\-\_\-byte\-\_\-stream} (\hyperlink{msgcell_8h_ab374f08df1c05b1837ad2e4f130d3cca}{M\-S\-G\-C\-E\-L\-L} $\ast$msgcellp, void $\ast$pdata, size\-\_\-t datalen)
\item 
void $\ast$ \hyperlink{msgdeque_8c_a66e44a1525ad0ea442ed7b3dc1686df3}{msgdeque\-\_\-rec\-\_\-byte\-\_\-stream} (\hyperlink{msgcell_8h_ab374f08df1c05b1837ad2e4f130d3cca}{M\-S\-G\-C\-E\-L\-L} $\ast$msgcellp, size\-\_\-t $\ast$bytes\-\_\-received)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Message Deque Facility for Inter-\/process Communications. This module provides a simple process-\/to-\/process communications mechanism using memory mapped dequeues and message cells (P\-O\-S\-I\-X semaphores). For the message cell implementation, see \hyperlink{msgcell_8h}{msgcell.\-h} and \hyperlink{msgcell_8c}{msgcell.\-c} 

Definition in file \hyperlink{msgdeque_8c_source}{msgdeque.\-c}.



\subsection{Macro Definition Documentation}
\hypertarget{msgdeque_8c_a6e6c3ac1e4ac58370515721b187b2758}{\index{msgdeque.\-c@{msgdeque.\-c}!D\-E\-Q\-U\-E\-P\-R\-E\-F\-I\-X@{D\-E\-Q\-U\-E\-P\-R\-E\-F\-I\-X}}
\index{D\-E\-Q\-U\-E\-P\-R\-E\-F\-I\-X@{D\-E\-Q\-U\-E\-P\-R\-E\-F\-I\-X}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{D\-E\-Q\-U\-E\-P\-R\-E\-F\-I\-X}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-E\-Q\-U\-E\-P\-R\-E\-F\-I\-X~\char`\"{}msgdeque-\/\char`\"{}}}\label{msgdeque_8c_a6e6c3ac1e4ac58370515721b187b2758}


Definition at line 52 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_ab34725ee75fd5fcf782cd33cfffa8601}{\index{msgdeque.\-c@{msgdeque.\-c}!L\-O\-C\-K\-P\-R\-E\-F\-I\-X@{L\-O\-C\-K\-P\-R\-E\-F\-I\-X}}
\index{L\-O\-C\-K\-P\-R\-E\-F\-I\-X@{L\-O\-C\-K\-P\-R\-E\-F\-I\-X}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{L\-O\-C\-K\-P\-R\-E\-F\-I\-X}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-O\-C\-K\-P\-R\-E\-F\-I\-X~\char`\"{}msgdeque-\/lock-\/\char`\"{}}}\label{msgdeque_8c_ab34725ee75fd5fcf782cd33cfffa8601}


Definition at line 53 of file msgdeque.\-c.



\subsection{Function Documentation}
\hypertarget{msgdeque_8c_aecaab2ef8f017bd42fcb1ad62845a3b4}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-attach@{msgdeque\-\_\-attach}}
\index{msgdeque\-\_\-attach@{msgdeque\-\_\-attach}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-attach}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\-S\-G\-C\-E\-L\-L}$\ast$ msgdeque\-\_\-attach (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_aecaab2ef8f017bd42fcb1ad62845a3b4}


Attach to a previously created message deque. 


\begin{DoxyParams}{Parameters}
{\em name} & name of the dequeue \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to the created M\-S\-G\-C\-E\-L\-L structure. 
\end{DoxyReturn}


Definition at line 169 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_a3be2abb141dd705931d15e996335d302}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-create@{msgdeque\-\_\-create}}
\index{msgdeque\-\_\-create@{msgdeque\-\_\-create}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-create}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\-S\-G\-C\-E\-L\-L}$\ast$ msgdeque\-\_\-create (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{name, }
\item[{uint}]{permissions, }
\item[{ushort}]{item\-\_\-size, }
\item[{ushort}]{nitems}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_a3be2abb141dd705931d15e996335d302}


Create a message deque structure. This will consist of at msgcell and a memory mapped dequeue. This form sets up a message dequeue that accepts records of a fixed length specified by item\-\_\-size. 

To send to the dequeue use the msgdeque\-\_\-send function. The receive from the dequeue call the msgdeque\-\_\-rec function.


\begin{DoxyParams}{Parameters}
{\em name} & name of the dequeue \\
\hline
{\em permissions} & access permissions (see open(2) \\
\hline
{\em item\-\_\-size} & size of the records accepted by this dequeue. \\
\hline
{\em nitems} & maximum capacity of the dequeue. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to the created M\-S\-G\-C\-E\-L\-L structure. 
\end{DoxyReturn}


Definition at line 118 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_adf55d7fab84947e2c15bb9878bcae0d7}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-create\-\_\-byte\-\_\-stream@{msgdeque\-\_\-create\-\_\-byte\-\_\-stream}}
\index{msgdeque\-\_\-create\-\_\-byte\-\_\-stream@{msgdeque\-\_\-create\-\_\-byte\-\_\-stream}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-create\-\_\-byte\-\_\-stream}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\-S\-G\-C\-E\-L\-L}$\ast$ msgdeque\-\_\-create\-\_\-byte\-\_\-stream (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{name, }
\item[{uint}]{permissions, }
\item[{ushort}]{byte\-\_\-capacity}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_adf55d7fab84947e2c15bb9878bcae0d7}


Create a message deque structure for \char`\"{}byte streams\char`\"{}. This will consist of at msgcell and a memory mapped dequeue. This function sets up a message dequeue that accepts variable length byte sequences. 

To send to the dequeue use the msgdeque\-\_\-send\-\_\-bytes function. The receive from the dequeue call the msgdeque\-\_\-rec\-\_\-bytes function.


\begin{DoxyParams}{Parameters}
{\em name} & name of the dequeue \\
\hline
{\em permissions} & access permissions (see open(2) \\
\hline
{\em byte\-\_\-capacity} & maximum capacity of the dequeue in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to the created M\-S\-G\-C\-E\-L\-L structure. 
\end{DoxyReturn}


Definition at line 160 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_af1ab89e5113e335fb7f329f700eef400}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-datacheck@{msgdeque\-\_\-datacheck}}
\index{msgdeque\-\_\-datacheck@{msgdeque\-\_\-datacheck}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-datacheck}]{\setlength{\rightskip}{0pt plus 5cm}int msgdeque\-\_\-datacheck (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{datap}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_af1ab89e5113e335fb7f329f700eef400}


Data check function for message deques. 

Principally for internal use by this module.


\begin{DoxyParams}{Parameters}
{\em datap} & Pointer to a M\-S\-G\-D\-E\-Q\-U\-E structure. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if fresh data is available. 0 if data not available. 
\end{DoxyReturn}


Definition at line 64 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_ab12130a3596f957f0aa9f26c5619c21b}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-rec@{msgdeque\-\_\-rec}}
\index{msgdeque\-\_\-rec@{msgdeque\-\_\-rec}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-rec}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ msgdeque\-\_\-rec (
\begin{DoxyParamCaption}
\item[{{\bf M\-S\-G\-C\-E\-L\-L} $\ast$}]{msgcellp}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_ab12130a3596f957f0aa9f26c5619c21b}
Receive a fixed length record. Size was defined when the deque was created (see msgdeque\-\_\-create). The function blocks until a record is available.\-A return value of N\-U\-L\-L indicates an error has occurred.


\begin{DoxyParams}{Parameters}
{\em msgcellp} & pointer to the message cell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to received record. 
\end{DoxyReturn}


Definition at line 277 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_a66e44a1525ad0ea442ed7b3dc1686df3}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-rec\-\_\-byte\-\_\-stream@{msgdeque\-\_\-rec\-\_\-byte\-\_\-stream}}
\index{msgdeque\-\_\-rec\-\_\-byte\-\_\-stream@{msgdeque\-\_\-rec\-\_\-byte\-\_\-stream}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-rec\-\_\-byte\-\_\-stream}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ msgdeque\-\_\-rec\-\_\-byte\-\_\-stream (
\begin{DoxyParamCaption}
\item[{{\bf M\-S\-G\-C\-E\-L\-L} $\ast$}]{msgcellp, }
\item[{size\-\_\-t $\ast$}]{bytes\-\_\-received}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_a66e44a1525ad0ea442ed7b3dc1686df3}
Receive bytes on a deque created by msgdeque\-\_\-create\-\_\-byte\-\_\-stream The buffer returned by this function must be released by calling free.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000002}{Todo}]Investigate using the packet send/receive functions of \hyperlink{mmdeque_8c}{mmdeque.\-c} as the basis for this function.\end{DoxyRefDesc}



\begin{DoxyParams}{Parameters}
{\em msgcellp} & pointer to the message cell \\
\hline
{\em bytes\-\_\-received} & pointer to size\-\_\-t to receive number of bytes received. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to received data bytes 
\end{DoxyReturn}


Definition at line 379 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_a39f497a1b7d9d650af064d383886b818}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-reset@{msgdeque\-\_\-reset}}
\index{msgdeque\-\_\-reset@{msgdeque\-\_\-reset}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-reset}]{\setlength{\rightskip}{0pt plus 5cm}int msgdeque\-\_\-reset (
\begin{DoxyParamCaption}
\item[{{\bf M\-S\-G\-C\-E\-L\-L} $\ast$}]{msgcellp}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_a39f497a1b7d9d650af064d383886b818}


Reset a message deque to the empty state and clear the sempahore. 

This can have unpredictable results if unruly senders are calling msgdeque\-\_\-send


\begin{DoxyParams}{Parameters}
{\em msgcellp} & pointer to a M\-S\-G\-C\-E\-L\-L structure returned by create or attach functions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, non-\/zero on failure 
\end{DoxyReturn}


Definition at line 205 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_afb93eb01c51f6b01f37c43771c416ee7}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-send@{msgdeque\-\_\-send}}
\index{msgdeque\-\_\-send@{msgdeque\-\_\-send}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-send}]{\setlength{\rightskip}{0pt plus 5cm}int msgdeque\-\_\-send (
\begin{DoxyParamCaption}
\item[{{\bf M\-S\-G\-C\-E\-L\-L} $\ast$}]{msgcellp, }
\item[{void $\ast$}]{sendp}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_afb93eb01c51f6b01f37c43771c416ee7}
Send a fixed length record. Size was defined when the message deque was created by msdeque\-\_\-create.


\begin{DoxyParams}{Parameters}
{\em msgcellp} & pointer to the message cell \\
\hline
{\em sendp} & void pointer to the record to be sent \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, non-\/zero if deque is full. In that case, the data pointed to by sendp was not inserted. 
\end{DoxyReturn}


Definition at line 250 of file msgdeque.\-c.

\hypertarget{msgdeque_8c_aed54e36c001d914878bc7b9d493301ac}{\index{msgdeque.\-c@{msgdeque.\-c}!msgdeque\-\_\-send\-\_\-byte\-\_\-stream@{msgdeque\-\_\-send\-\_\-byte\-\_\-stream}}
\index{msgdeque\-\_\-send\-\_\-byte\-\_\-stream@{msgdeque\-\_\-send\-\_\-byte\-\_\-stream}!msgdeque.c@{msgdeque.\-c}}
\subsubsection[{msgdeque\-\_\-send\-\_\-byte\-\_\-stream}]{\setlength{\rightskip}{0pt plus 5cm}int msgdeque\-\_\-send\-\_\-byte\-\_\-stream (
\begin{DoxyParamCaption}
\item[{{\bf M\-S\-G\-C\-E\-L\-L} $\ast$}]{msgcellp, }
\item[{void $\ast$}]{pdata, }
\item[{size\-\_\-t}]{datalen}
\end{DoxyParamCaption}
)}}\label{msgdeque_8c_aed54e36c001d914878bc7b9d493301ac}
Send to a byte stream deque. .A byte stream dequeue was created by calling msgdeque\-\_\-create\-\_\-byte\-\_\-stream.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000001}{Todo}]Investigate using the packet send/receive functions of \hyperlink{mmdeque_8c}{mmdeque.\-c} as the basis for this function.\end{DoxyRefDesc}



\begin{DoxyParams}{Parameters}
{\em msgcellp} & pointer to the message cell \\
\hline
{\em pdata} & pointer to the bytes to be send \\
\hline
{\em datalen} & number of bytes to send \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, non-\/zero on failure. 
\end{DoxyReturn}


Definition at line 335 of file msgdeque.\-c.

